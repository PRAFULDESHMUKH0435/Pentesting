import 'package:flutter/foundation.dart';
import 'package:hive/hive.dart';
import 'package:pentesting/Models/CartModel.dart';
class CartProvider with ChangeNotifier{

  int cartQuantity =0;
  var cartbox = Hive.box("CartItemsBox");
  List cartitemslist=[];
  double totalamount =0.0;


  GetCartItemsList(){
    var cartitemslist = cartbox.toMap().values.toList();
    print("Total Amount Is ${totalamount}");
    return cartitemslist;
  }


  GetCartCount(){
    cartQuantity = cartbox.toMap().values.length;
    print("CartQuantity Is ${cartQuantity}");
    notifyListeners();
    return cartQuantity;
  }

  AddItemToCart(CartModel cartModel){
    cartitemslist = cartbox.toMap().values.toList();
    print("Initial CartItems List From CartBox IS ${cartitemslist}");
    cartbox.add(cartModel);
    cartitemslist = cartbox.toMap().values.toList();
    print("Final CartItems List From CartBox IS ${cartitemslist}");
    GetCartCount();
    notifyListeners();
  }


  DeleteItemModelFromBox(int index){
    cartitemslist = cartbox.toMap().values.toList();
    print("CartList Before Deleting Is ${cartitemslist}");
    print("CartItemsList Length Before Deleting Is ${cartitemslist.length}");

    if(index<cartitemslist.length){
      cartbox.deleteAt(index);
      cartitemslist.removeAt(index);
      cartQuantity-=1;
    }else{
      print("Error In Deleting Item At Index ${index}");
    }
    print("Updated List After Deleting Is ${cartitemslist}");
    notifyListeners();
  }
}