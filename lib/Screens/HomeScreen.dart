import 'package:another_carousel_pro/another_carousel_pro.dart';
import 'package:curved_labeled_navigation_bar/curved_navigation_bar.dart';
import 'package:curved_labeled_navigation_bar/curved_navigation_bar_item.dart';
import 'package:flutter/cupertino.dart';
import 'package:flutter/material.dart';
import 'package:pentesting/CommonHelper/BusinessLogic.dart';
import 'package:pentesting/CommonHelper/Drawer.dart';
import 'package:pentesting/Theme/ThemeProvider.dart';
import 'package:provider/provider.dart';
import '../CommonHelper/BuildData.dart';
import '../CommonHelper/Constants.dart';

class HomeScreen extends StatefulWidget {
  const HomeScreen({super.key});

  @override
  State<HomeScreen> createState() => _HomeScreenState();
}

class _HomeScreenState extends State<HomeScreen> {

  BusinessLogic bl = BusinessLogic();

  @override
  Widget build(BuildContext context) {
    final pro = Provider.of<ThemeProvider>(context);
    return Scaffold(
      drawer: MyDrawer(),
      appBar: AppBar(
        title: Text("Kirana",style: titlestyle,),
        // backgroundColor: Colors.grey,
        actions: [
         IconButton(onPressed: (){
           pro.istoggle=!pro.istoggle;
          Provider.of<ThemeProvider>(context,listen: false).toggleTheme();
         }, icon: Provider.of<ThemeProvider>(context).istoggle?Icon(Icons.toggle_on_outlined): Icon(Icons.toggle_off_outlined)),
        ],
      ),
      body: Container(
        // color: Colors.grey,
        margin: EdgeInsets.symmetric(horizontal: 5.0,vertical: 5.0),
        child: Column(
          children: [
            /// BANNER CONTAINER
            Container(
                height: 250,
                child: AnotherCarousel(
                  boxFit: BoxFit.fill,
                  borderRadius: true,
                  images: [
                    NetworkImage('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTdWNVWIM5aDGV_r5Nwsvph996CASpbw6Fmgw&usqp=CAU'),
                    NetworkImage('https://www.icoderzsolutions.com/blog/wp-content/uploads/2019/05/Grocery-App-An-Assured-Way-To-Grow-Your-Grocery-Business.jpg'),
                    NetworkImage('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT4VLZiAzxkXGCst1EIsiW5PGEogX6Sw7yIc8WEXAOB96uwZIQrMS5Z0S_9smaiRP7k_18&usqp=CAU'),
                  ],
                )
            ),
            /// GRID VIEW
            Expanded(
              child: FutureBuilder(
                future: bl.LoadData(""),
                builder: (context,snapshot){
                  if(snapshot.connectionState==ConnectionState.waiting){
                    return Center(child: CircularProgressIndicator());
                  }else if(snapshot.connectionState==ConnectionState.done ||snapshot.connectionState==ConnectionState.active){
                    return GridView.builder(
                        gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(crossAxisCount: 2),
                        itemCount: bl.itemslist3.length,
                        itemBuilder: (context,index){
                          return BuildData(
                            pro_image: bl.itemslist3[index].productimage,
                            pro_name: bl.itemslist3[index].productname,
                            pro_price: bl.itemslist3[index].productprice,
                            pro_description: bl.itemslist3[index].productdescription,
                          );
                        });
                  }else{
                    return Text("Something Went Wrong");
                  }
                },
              ),
            )
          ],
        ),
      ),
      bottomNavigationBar: CurvedNavigationBar(
        // backgroundColor: Colors.white70,
        // color: Colors.grey,
        items: [
          CurvedNavigationBarItem(
            child: Image.asset('Assets/Images/fruit.png',height: 45.0,width: 45.0,),
            label: 'Fruits',
          ),
          CurvedNavigationBarItem(
            child: Image.asset('Assets/Images/vegetable.png',height: 45.0,width: 45.0),
            label: 'Vegetables',
          ),
          CurvedNavigationBarItem(
            child: Image.asset('Assets/Images/basket.png',height: 45.0,width: 45.0),
            label: 'Grocery',
          ),

        ],
        onTap: (index) {
          setState(() {
            print("Index Is ${index}");
          });
        },
      ),
    );
  }
}
